<div *ngIf="hasPermission(permissionApp.CRM_CUST_13)">
  <mat-accordion>
    <div class="form-field-full">
      <mat-card>
        <form [formGroup]="formChangeVehicle">
          <div fxLayout="row wrap" fxLayoutGap="20px grid">
            <div fxFlex="50" fxFlex.lt-sm="100" class="licensePlates">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.licensePlates'
                  | translate}} <span class="required">*</span></mat-label>
                <input matInput placeholder="{{'customer-management.newVehicleForm.licensePlates'
                  | translate}}" formControlName="licensePlates" />
                <mat-error *ngIf="formChangeVehicle.get('licensePlates').errors?.required">
                  {{'customer-management.errorMessageVehicle.licensePlates' |
                  translate}}
                </mat-error>
                <mat-error *ngIf="formChangeVehicle.get('licensePlates').errors?.cannotWhiteSpace">
                  {{'common.space_error' | translate}}
                </mat-error>
                <mat-error *ngIf="formChangeVehicle.get('licensePlates').errors?.maxlength">
                  {{'common.validate.maxlength-16' | translate}}
                </mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.lt-sm="100">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.vehicleOwner' |
                  translate}} <span class="required">*</span></mat-label>
                <input matInput placeholder="{{'customer-management.newVehicleForm.vehicleOwner'
                  | translate}}" formControlName="vehicleOwner" />
                <button mat-button *ngIf="formChangeVehicle.controls.vehicleOwner.value" matSuffix mat-icon-button
                  aria-label="Clear"
                  (click)="formChangeVehicle.controls.vehicleOwner.setValue(null); $event.stopPropagation()"
                  class="showclear">
                  <mat-icon>close</mat-icon>
                </button>
                <mat-error *ngIf="formChangeVehicle.get('vehicleOwner').errors?.required">
                  {{'customer-management.errorMessageVehicle.vehicleOwner' |
                  translate}}
                </mat-error>
                <mat-error *ngIf="formChangeVehicle.get('vehicleOwner').errors?.cannotWhiteSpace">
                  {{'common.space_error' | translate}}
                </mat-error>
                <mat-error *ngIf="formChangeVehicle.get('vehicleOwner').errors?.maxlength">
                  {{'common.validate.maxlength-255' | translate}}
                </mat-error>
              </mat-form-field>
            </div>
          </div>
          <div fxLayout="row wrap" fxLayoutGap="20px grid">
            <div fxFlex="50" fxFlex.lt-sm="100" class="vehicleType">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.vehicleType'
                  | translate}} <span class="required">*</span></mat-label>
                <mtx-select [items]="listOptionVehicelType" bindLabel="value" bindValue="id" [multiple]="false"
                  formControlName="vehicleTypeName" [notFoundText]="'common.notFound' | translate"
                  [searchable]="listOptionVehicelType?.length>10" (change)="getDefaultVehicleGroup()">
                </mtx-select>
                <mat-error *ngIf="formChangeVehicle.controls.vehicleTypeName.errors?.required">
                  {{'customer-management.errorMessageVehicle.vehicleType' | translate}}
                </mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="25" fxFlex.lt-sm="100" class="vehicleWeight">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.vehicleWeight'
                  | translate}} </mat-label>
                <input matInput type="number" placeholder="{{'customer-management.newVehicleForm.vehicleWeight'
                  | translate}}" formControlName="vehicleWeight" (change)="getDefaultVehicleGroup()" />
              </mat-form-field>
            </div>
            <div fxFlex="25" fxFlex.lt-sm="100" class="merchandiseWeight">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.merchandiseWeight'
                  | translate}}</mat-label>
                <input matInput type="number" placeholder="{{'customer-management.newVehicleForm.merchandiseWeight'
                  | translate}}" formControlName="merchandiseWeight" (change)="getDefaultVehicleGroup()" />
              </mat-form-field>
            </div>
          </div>
          <div fxLayout="row wrap" fxLayoutGap="20px grid">
            <div fxFlex="25" fxFlex.lt-sm="100" class="seatsNumber">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.seatsNumber' |
                  translate}} <span class="required">*</span></mat-label>
                <input matInput type="number" placeholder="{{'customer-management.newVehicleForm.seatsNumber'
                  | translate}}" formControlName="seatsNumber" (change)="getDefaultVehicleGroup()" />
              </mat-form-field>
            </div>
            <div fxFlex="25" fxFlex.lt-sm="100">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.vehicleNumber'
                  | translate}}</mat-label>
                <input matInput placeholder="{{'customer-management.newVehicleForm.vehicleNumber'
                  | translate}}" formControlName="vehicleNumber" />
                <button mat-button *ngIf="formChangeVehicle.controls.vehicleNumber.value" matSuffix mat-icon-button
                  aria-label="Clear"
                  (click)="formChangeVehicle.controls.vehicleNumber.setValue(null); $event.stopPropagation()"
                  class="showclear">
                  <mat-icon>close</mat-icon>
                </button>
                <mat-error *ngIf="formChangeVehicle.get('vehicleNumber').errors?.cannotWhiteSpace">
                  {{'common.space_error' | translate}}
                </mat-error>
                <mat-error *ngIf="formChangeVehicle.get('vehicleNumber').errors?.maxlength">
                  {{'common.validate.maxlength-50' | translate}}
                </mat-error>
              </mat-form-field>
            </div>

            <div fxFlex="25" fxFlex.lt-sm="100">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.allWeight' |
                  translate}}
                </mat-label>
                <input matInput type="number" placeholder="{{'customer-management.newVehicleForm.allWeight'
                  | translate}}" formControlName="allWeight" (change)="getDefaultVehicleGroup()" />
                <button mat-button *ngIf="formChangeVehicle.controls.allWeight.value" matSuffix mat-icon-button
                  aria-label="Clear"
                  (click)="formChangeVehicle.controls.allWeight.setValue(null); $event.stopPropagation()"
                  class="showclear">
                  <mat-icon>close</mat-icon>
                </button>
                <mat-error *ngIf="formChangeVehicle.get('allWeight').errors?.min">
                  {{'customer-management.errorMessageVehicle.min' |
                  translate}}
                </mat-error>
                <mat-error
                  *ngIf="formChangeVehicle.get('allWeight').errors?.max && !formChangeVehicle.get('allWeight').errors?.pattern">
                  {{'customer-management.errorMessageVehicle.max' |
                  translate}}
                </mat-error>
                <mat-error *ngIf="formChangeVehicle.get('allWeight').errors?.pattern">
                  {{'common.wrong-format-weight' |
                  translate}}
                </mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="25" fxFlex.lt-sm="100">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.followWeight' |
                  translate}}</mat-label>
                <input matInput type="number" placeholder="{{'customer-management.newVehicleForm.followWeight'
                  | translate}}" formControlName="followWeight" (change)="getDefaultVehicleGroup()" />
                <button mat-button *ngIf="formChangeVehicle.controls.followWeight.value" matSuffix mat-icon-button
                  aria-label="Clear"
                  (click)="formChangeVehicle.controls.followWeight.setValue(null); $event.stopPropagation()"
                  class="showclear">
                  <mat-icon>close</mat-icon>
                </button>
                <mat-error *ngIf="formChangeVehicle.get('followWeight').errors?.min">
                  {{'customer-management.errorMessageVehicle.min' |
                  translate}}
                </mat-error>
                <mat-error
                  *ngIf="formChangeVehicle.get('followWeight').errors?.max && !formChangeVehicle.get('followWeight').errors?.pattern">
                  {{'customer-management.errorMessageVehicle.max' |
                  translate}}
                </mat-error>
                <mat-error *ngIf="formChangeVehicle.get('followWeight').errors?.pattern">
                  {{'common.wrong-format-weight' |
                  translate}}
                </mat-error>
              </mat-form-field>
            </div>
          </div>
          <div fxLayout="row wrap" fxLayoutGap="20px grid">
            <div fxFlex="50" fxFlex.lt-sm="100" class="vehiclesTypeFee">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.vehiclesTypeFee'
                  | translate}} <span class="required">*</span></mat-label>
                <mtx-select [items]=" listOptionVehicleTypeFee" bindLabel="value" bindValue="id" [multiple]="false"
                  formControlName="vehiclesTypeFeeName" [notFoundText]="'common.notFound' | translate"
                  [dropdownPosition]="'bottom'" [searchable]="listOptionVehicleTypeFee?.length>10">
                </mtx-select>
              </mat-form-field>
            </div>
            <div fxFlex="25" fxFlex.lt-sm="100">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.framesNumber' |
                  translate}}</mat-label>
                <input matInput placeholder="{{'customer-management.newVehicleForm.framesNumber'
                  | translate}}" formControlName="framesNumber" />
                <button mat-button *ngIf="formChangeVehicle.controls.framesNumber.value" matSuffix mat-icon-button
                  aria-label="Clear"
                  (click)="formChangeVehicle.controls.framesNumber.setValue(null); $event.stopPropagation()"
                  class="showclear">
                  <mat-icon>close</mat-icon>
                </button>
                <mat-error *ngIf="formChangeVehicle.get('framesNumber').errors?.cannotWhiteSpace">
                  {{'common.space_error' | translate}}
                </mat-error>
                <mat-error *ngIf="formChangeVehicle.get('framesNumber').errors?.maxlength">
                  {{'common.validate.maxlength-50' | translate}}
                </mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="25" fxFlex.lt-sm="100">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.color' |
                  translate}}</mat-label>
                <mat-select formControlName="color">
                  <mat-option>{{ 'common.default-select' | translate }}</mat-option>
                  <ng-container *ngFor="let item of listOptionVehicleColours">
                    <mat-option [value]="item.code">{{item.value}}</mat-option>
                  </ng-container>
                </mat-select>
                <button *ngIf="formChangeVehicle.controls.color.value" matSuffix mat-icon-button type="button"
                  class="btn-clear-drop"
                  (click)="formChangeVehicle.controls.color.setValue(null); $event.stopPropagation();">
                  <mat-icon>close</mat-icon>
                </button>
              </mat-form-field>
            </div>
          </div>
          <div fxLayout="row wrap" fxLayoutGap="20px grid">
            <div fxFlex="25" fxFlex.lt-sm="100">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.label' |
                  translate}}</mat-label>
                <mat-select formControlName="label">
                  <mat-option>{{ 'common.default-select' | translate }}</mat-option>
                  <ng-container *ngFor="let item of listOptionVehicleLabel">
                    <mat-option [value]="item.code">{{item.value}}</mat-option>
                  </ng-container>
                </mat-select>
                <button *ngIf="formChangeVehicle.controls.label.value" matSuffix mat-icon-button type="button"
                  class="btn-clear-drop"
                  (click)="formChangeVehicle.controls.label.setValue(null); $event.stopPropagation();">
                  <mat-icon>close</mat-icon>
                </button>
              </mat-form-field>
            </div>
            <div fxFlex="25" fxFlex.lt-sm="100">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.vehiclesSeri' |
                  translate}}</mat-label>
                <mat-select formControlName="vehiclesSeri">
                  <mat-option>{{ 'common.default-select' | translate }}</mat-option>
                  <ng-container *ngFor="let item of listOptionVehicleBrands">
                    <mat-option [value]="item.code">{{item.value}}</mat-option>
                  </ng-container>
                </mat-select>
                <button *ngIf="formChangeVehicle.controls.vehiclesSeri.value" matSuffix mat-icon-button type="button"
                  class="btn-clear-drop"
                  (click)="formChangeVehicle.controls.vehiclesSeri.setValue(null); $event.stopPropagation();">
                  <mat-icon>close</mat-icon>
                </button>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.lt-sm="100">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.licensePlateType'
                  | translate}} <span class="required">*</span></mat-label>
                <mat-select formControlName="licensePlateType">
                  <ng-container *ngFor="let item of
                    listOptionVehiclePlateTypes">
                    <mat-option [value]="item.id">{{item.value}}</mat-option>
                  </ng-container>
                </mat-select>
                <button *ngIf="formChangeVehicle.controls.licensePlateType.value" matSuffix mat-icon-button
                  type="button" class="btn-clear-drop"
                  (click)="formChangeVehicle.controls.licensePlateType.setValue(null); $event.stopPropagation();">
                  <mat-icon>close</mat-icon>
                </button>
                <mat-error *ngIf="formChangeVehicle.get('licensePlateType').errors?.required">
                  {{'customer-management.errorMessageVehicle.licensePlateType' |
                  translate}}
                </mat-error>
              </mat-form-field>
            </div>
          </div>
          <div fxLayout="row wrap" fxLayoutGap="20px grid">
            <div fxFlex="50" fxFlex.lt-sm="100" class="staff">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.staff' |
                  translate}} <span class="required">*</span>
                </mat-label>
                <input matInput placeholder="{{'customer-management.newVehicleForm.staff' |
                  translate}}" formControlName="staff" />
                <mat-error *ngIf="formChangeVehicle.get('staff').errors?.required">
                  {{'customer-management.errorMessageVehicle.staff' |
                  translate}}
                </mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.lt-sm="100" class="seriNumber">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.seriNumber' |
                  translate}} </mat-label>
                <input matInput placeholder="{{'customer-management.newVehicleForm.seriNumber'
                  | translate}}" formControlName="seriNumber" />
                <mat-error *ngIf="formChangeVehicle.get('seriNumber').errors?.cannotWhiteSpace">
                  {{'common.space_error' | translate}}
                </mat-error>
                <mat-error *ngIf="formChangeVehicle.get('seriNumber').errors?.maxlength">
                  {{'common.validate.maxlength-50' | translate}}
                </mat-error>
              </mat-form-field>
            </div>
          </div>
          <div fxLayout="row wrap" fxLayoutGap="20px grid">
            <div fxFlex="50" fxFlex.lt-sm="100">
              <mat-form-field appearance="outline">
                <mat-label>{{'customer-management.newVehicleForm.reason' |
                  translate}}<span class="required">*</span>
                </mat-label>
                <mat-select formControlName="reason">
                  <ng-container *ngFor="let item of listOptionReason">
                    <mat-option [value]="item.code">{{item.value}}</mat-option>
                  </ng-container>
                </mat-select>
                <button *ngIf="formChangeVehicle.controls.reason.value" matSuffix mat-icon-button type="button"
                  class="btn-clear-drop"
                  (click)="formChangeVehicle.controls.reason.setValue(null); $event.stopPropagation();">
                  <mat-icon>close</mat-icon>
                </button>
                <mat-error *ngIf="formChangeVehicle.get('reason').errors?.required">
                  {{'customer-management.errorMessageVehicle.reason' |
                  translate}}
                </mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.lt-sm="100">
              <div class="crm__table">
                <table mat-table [dataSource]="listDataTotal" #tableFee>
                  <ng-container *ngFor="let item of columnsFee" [ngSwitch]="item.field">
                    <ng-container matColumnDef="{{item.field}}" *ngSwitchDefault>
                      <th mat-header-cell *matHeaderCellDef>{{item.i18n |
                        translate}}</th>
                      <td mat-cell *matCellDef="let row; let i = index">
                        <p *ngIf="i == 0 && item.field != 'price'"> {{row[item.field]}}</p>
                        <p *ngIf="i == 0 && item.field == 'price'" style="text-align: right;"> {{row[item.field]}}</p>
                        <p *ngIf="i == 1  && item.field != 'price'" style="font-weight: bold;"> {{row[item.field]}}</p>
                        <p *ngIf="i == 1 && item.field == 'price'" style="font-weight: bold; text-align: right;">
                          {{row[item.field]}}</p>
                      </td>
                    </ng-container>
                  </ng-container>
                  <tr mat-header-row *matHeaderRowDef="displayedColumnsFee"></tr>
                  <tr mat-row *matRowDef="let row; columns:
                  displayedColumnsFee">
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </form>
        <div fxLayout="row wrap" fxLayoutAlign="end">
          <button mat-button class="float-right ml-20 mt-25" mat-raised-button color="secondary"
            (click)="onResetForm()">{{'common.button.reEnter' | translate}}</button>
          <button class="float-right ml-20 mt-25" mat-button mat-raised-button [disabled]="formChangeVehicle.invalid"
            color="primary" (click)="updateVehicle()">{{'common.button.save' |
            translate}}</button>
        </div>
      </mat-card>
    </div>
  </mat-accordion>
</div>
<div *ngIf="!hasPermission(permissionApp.CRM_CUST_13)">
  <error-code code="403" [title]="'common.invalid-permission-title'" [message]="'common.invalid-permission'">
  </error-code>
</div>
